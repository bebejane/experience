(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{36:function(e,t,n){e.exports=n(78)},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},73:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(80),o=n(29),c=n.n(o),s=(n(41),n(9)),l=n(2),u=n(3),d=n(4),f=n(5),h=(n(42),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={icon:e.icon,toggle:e.togle,disabled:e.disabled},a}return Object(u.a)(n,[{key:"onClick",value:function(e){this.props.onClick(e)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.icon,a=(t.toggle,t.disabled),i=t.size;return r.a.createElement("div",{className:"button",style:i?{fontSize:i}:void 0,disabled:a,onClick:function(t){return e.onClick(t)}},n)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),m=(n(43),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={id:e.id,unread:e.unread,count:e.count,name:e.name,url:e.url,selected:e.selected,notools:e.notools,refreshing:e.refreshing,edit:!1},a}return Object(u.a)(n,[{key:"onClick",value:function(e){var t=this;this.state.selected?this.setState({edit:this.state.name}):this.setState({selected:!0,edit:!1},(function(){return t.props.onClick(e)}))}},{key:"onChange",value:function(e){console.log(e.target.value),this.setState({edit:e.target.value})}},{key:"onSubmit",value:function(e){var t=this,n=this.state.edit;this.setState({selected:!0,edit:!1,name:n},(function(){t.props.onUpdate(t.state.id,n)})),e.preventDefault()}},{key:"deleteFeed",value:function(e){this.props.onRemove()}},{key:"refreshFeed",value:function(e){this.props.onRefresh(e),this.setState({refreshing:!0})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.name,a=t.id,i=t.selected,o=t.notools,c=t.unread,s=t.edit,l=this.state.loading;return l?r.a.createElement("div",{className:"loading"},r.a.createElement("div",null,l)):r.a.createElement("div",{key:a,className:"source-card"+(i?" source-card-selected":"")},r.a.createElement("div",{className:"source-card-unread"},c),r.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)}},r.a.createElement("input",{type:"text",className:"source-card-title",value:s||n,onChange:function(t){return e.onChange(t)},readOnly:!s,onClick:function(){return e.onClick(a)}})),!o&&r.a.createElement("div",{className:"source-card-tools"},r.a.createElement("div",{className:"source-card-tool",onClick:function(){return e.deleteFeed(a)}},"-")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),v=(n(44),n(10)),g=function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={message:e.term,loading:e.loading},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.message;return e.loading?r.a.createElement("div",{className:"loading"},t&&r.a.createElement("div",{className:"loading-message"},t),r.a.createElement("div",{className:"loading-icon"},r.a.createElement(v.d,{className:"icon-spin"}))):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component),p=(n(45),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={id:e.id,article:e.article},a}return Object(u.a)(n,[{key:"onClick",value:function(e,t){this.setState({selected:this.state.id}),this.props.onClick(t)}},{key:"onToggleRead",value:function(){var e=!this.state.article.read;this.props.onToggleRead(this.state.article._id,e),this.setState({article:Object(s.a)({},this.state.article,{read:e})})}},{key:"deleteFeed",value:function(e){this.props.onRemove()}},{key:"refresh",value:function(){}},{key:"onRead",value:function(){}},{key:"onOpen",value:function(){this.props.onOpen()}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"feed-card-tools"},r.a.createElement(h,{onClick:function(t){return e.onToggleRead(t)},icon:r.a.createElement(v.b,null)}),r.a.createElement(h,{onClick:function(t){return e.onOpen(t)},icon:r.a.createElement(v.a,null)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),k=(n(46),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={id:e.id,feed:e.feed,article:e.article,view:e.view,refreshing:e.refreshing},a}return Object(u.a)(n,[{key:"onClick",value:function(e){console.log(this.state.article),this.setState({selected:this.state.article._id,url:e}),this.props.onClick(this.state.article._id,this.state.article.link)}},{key:"onToggleRead",value:function(){var e=!this.state.article.read;this.props.onToggleRead(this.state.article._id,e),this.setState({article:Object(s.a)({},this.state.article,{read:e})})}},{key:"deleteFeed",value:function(e){this.props.onRemove()}},{key:"refresh",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"contentSnippet",value:function(e){var t=e.contentSnippet||e.content||"";if(!t)return"";var n=t.split(".");return t=n.length>1?n.slice(0,2).join("."):t.substring(0,100)+"..."}},{key:"render",value:function(){var e=this,t=this.state,n=t.article,a=t.selected,i=t.view,o=t.feed,c="full"===i;return r.a.createElement("div",{className:"feed-card"+(a===n._id?" feed-card-selected":"")},r.a.createElement("div",{className:"feed-card-left"+(n.read?" feed-card-read":""),onClick:function(){return e.onClick(n._id,n.link)}},r.a.createElement("div",{className:"feed-card-title"},r.a.createElement("div",{className:"feed-card-date"},n.time," - ",o),n.title,c&&r.a.createElement("div",{className:"feed-card-content"},this.contentSnippet(n)))),r.a.createElement("div",{className:"feed-card-right"},c&&r.a.createElement(p,{article:n,onToggleRead:function(t){return e.onToggleRead()},onOpen:function(){return e.onClick(n.link)}})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),y=n(30),E=n.n(y),b=(n(47),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={id:e.id,name:e.name,view:e.view,url:e.url,selected:e.selected,articles:e.articles||[],refreshing:e.refreshing},a}return Object(u.a)(n,[{key:"onClick",value:function(e,t){this.setState({selected:e,url:t}),this.props.onClick(e,t)}},{key:"onToggleRead",value:function(e,t){this.props.onToggleRead(e,t)}},{key:"deleteFeed",value:function(e){this.props.onRemove()}},{key:"refresh",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.refreshing,a=t.articles,i=t.view,o=t.name;return a.forEach((function(e){e.time=E()(e.pubDate).fromNow()})),0===a.length?r.a.createElement("div",{className:"empty"},r.a.createElement("div",null,"Nothing heree")):r.a.createElement("div",{className:"feed"},n&&r.a.createElement(g,{message:"Loading feed...",loading:!0}),!n&&a.map((function(t,n){return r.a.createElement(k,{key:n,article:t,view:i,feed:t.feed?t.feed.name:o,onClick:function(n,a){return e.onClick(t._id,a)},onToggleRead:function(t,n){return e.onToggleRead(t,n)}})})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),C=n(11),S=n(31),O=n.n(S),j=(n(53),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={site:e.site,title:e.title,link:e.link},a}return Object(u.a)(n,[{key:"onClick",value:function(e){this.props.onClick(e)}},{key:"addFeed",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,a=t.link,i=O.a.parse(this.state.link).hostname;return r.a.createElement("div",{className:"search-card",onClick:function(){return e.onClick(a)}},r.a.createElement("div",{className:"search-card-title"},n,r.a.createElement("div",{className:"search-card-link"},i)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),N=(n(54),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={term:e.term,loading:!1,url:"",matches:[]},a.formRef=r.a.createRef(),a.urlRef=r.a.createRef(),a}return Object(u.a)(n,[{key:"onClick",value:function(e){this.setState({loading:!1,matches:[],url:""}),this.props.onClick(e)}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({loading:"Loading search"}),fetch("http://localhost:3001/api/search/"+encodeURIComponent(this.state.url)).then((function(e){return e.json()})).then((function(e){t.setState({matches:e.google})})).catch((function(e){return console.error(e)})).then((function(){return t.setState({loading:!1})}))}},{key:"onChange",value:function(e){this.setState(Object(C.a)({},e.target.id,e.target.value))}},{key:"refresh",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.matches,a=t.loading;return r.a.createElement("div",{className:"search-container"},r.a.createElement("form",{ref:this.formRef,onSubmit:function(t){return e.onSubmit(t)}},r.a.createElement("input",{className:"form-add",placeholder:"Add blog...",ref:this.urlRef,onChange:function(t){return e.onChange(t)},value:this.state.url,autoComplete:"off",type:"text",id:"url"})),r.a.createElement("div",{className:"search-result"},a&&r.a.createElement("div",{className:"search-loading"},r.a.createElement(v.c,{className:"icon-spin"})),!a&&n.map((function(t,n){return r.a.createElement(j,{key:n,site:t,title:t.title,link:t.link,onClick:function(){return e.onClick(t.link)}})}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),R=(n(55),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={error:e.error,show:!0},a}return Object(u.a)(n,[{key:"onClose",value:function(){this.props.onClose()}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.error;t.show;return n?r.a.createElement("div",{className:"error-wrap"},r.a.createElement("div",{className:"error-modal"},r.a.createElement("div",{className:"error-header"},"Error"),r.a.createElement("div",{className:"error-content"},r.a.createElement("div",{className:"error-message"},n.message," (",n.type,")"),r.a.createElement("div",{className:"error-bottom"},r.a.createElement("button",{onClick:function(){return e.onClose()}},"close"))))):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),n}(a.Component)),F=n(32),w=n.n(F),_=n(8),D=Object(_.a)(),T=n(34),I=n(33),M=(n(73),function(e){Object(f.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={url:"",feedId:null,loading:!1,loadingFeeds:!0,refreshing:!1,articles:[],feeds:[],search:[],page:1,pages:1,init:!1,view:"full",error:null},a}return Object(u.a)(n,[{key:"api",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{method:"get"};return console.log(a.method.toUpperCase(),e,n),w()({method:a.method||"get",url:"http://localhost:3001/api"+e,data:n}).then((function(e){if(e)return console.log(e.data),e})).catch((function(e){var n=e;throw e.response?(console.log("response error"),n=Object(s.a)({},e.response.data,{status:e.response.status,type:1})):e.request?(console.log("request error"),n={message:"Request error: "+e.message,status:e.request.status,type:2}):(n.type=3,console.log("network error")),console.log(n,e),t.setState({error:n}),new R(n)}))}},{key:"addFeed",value:function(e){var t=this;if(e){var n={url:e};return console.log("add feed",e),this.setState({loadingFeeds:"Adding feed...",search:[]}),this.api("/feed",n,{method:"post"}).then((function(e){return console.log(e),t.feeds().then((function(){return t.feed(e.data._id)}))})).catch((function(e){return t.setState({loadingFeeds:!1})}))}}},{key:"updateFeed",value:function(e,t){var n=this;return this.api("/feed",{_id:e,name:t},{method:"patch"}).then((function(e){var t=n.state.articles.map((function(t){return e.data._id===t._id?e.data:t}));return n.setState({articles:t}),e})).then((function(){return n.feeds(!0)})).catch((function(e){}))}},{key:"deleteFeed",value:function(e){var t=this;return this.api("/feed",{_id:e},{method:"delete"}).then((function(n){return e===t.state.feedId&&t.setState({articles:[],feedId:null}),n})).then((function(){return t.feeds(!0)})).catch((function(e){}))}},{key:"refreshFeed",value:function(e){var t=this;return this.setState({refreshing:e}),this.api("/feed/"+e+"/refresh",{},{method:"get"}).then((function(n){return e===t.state.feedId&&t.setState({articles:n.data}),n})).then((function(){return t.feeds(!0)})).catch((function(e){})).then((function(){return t.setState({refreshing:!1})}))}},{key:"loadFeed",value:function(e){var t=this;this.setState({refreshing:!0}),this.feed(e).then((function(e){})).catch((function(e){})).then((function(){return t.setState({refreshing:!1})}))}},{key:"openLink",value:function(e,t){var n=this;console.log("open link",t,e);var a=this.state.feedId,r=this.state.page;this.toggleRead(a,e,!0).then((function(e){D.replace("/feed/"+a+"/page/"+r,n.state),setTimeout((function(){return window.location=t}),1e3)})).catch((function(e){return n.setState({error:e})}))}},{key:"onToggleRead",value:function(e,t,n){var a=this;this.toggleRead(e,t,n).then((function(){return a.feeds(!0)})).catch((function(e){}))}},{key:"toggleRead",value:function(e,t,n){var a=this;return this.api("/feed/"+e,{_id:t,read:n},{method:"patch"}).then((function(e){var t=a.state.articles.map((function(t){return e.data._id===t._id?e.data:t}));return a.setState({articles:t}),e})).catch((function(e){throw e}))}},{key:"toggleAllRead",value:function(e){var t=this,n=this.state.articles,a=n.filter((function(e){return e.read})).length,r=n.map((function(e){return{read:!a,_id:e._id}}));return this.api("/feed/"+e,r,{method:"patch"}).then((function(e){return t.setState({articles:e.data})})).catch((function(e){throw e}))}},{key:"feeds",value:function(e){var t=this;return this.setState({loadingFeeds:!e}),this.api("/feed",{},{method:"get"}).then((function(e){return t.setState({feeds:e.data})})).catch((function(e){throw e})).then((function(){return t.setState({loadingFeeds:!1})}))}},{key:"feed",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{page:1};return this.setState({refreshing:e}),this.api("/feed/"+e+"/page/"+n.page,{},{method:"get"}).then((function(a){var r=a.data.data,i=a.data.page,o=a.data.pages,c=Object(s.a)({},t.state,{feedId:e,articles:r,refreshing:!1,page:i,pages:o});return D.push("/feed/"+e+"/page/"+n.page,c),t.setState(c),a.data})).catch((function(e){throw console.error(e),e})).then((function(e){return t.setState({refreshing:!1}),console.log("then"),e}))}},{key:"browse",value:function(e){var t=this,n=this.state.page+e;n>this.state.pages||n<=0||this.feed(this.state.feedId,{page:n}).then((function(e){var n=e.data;n.length?t.setState({articles:n,page:e.page}):t.setState({page:e.page-1})})).catch((function(e){}))}},{key:"error",value:function(e){}},{key:"componentDidMount",value:function(){var e=this;D.listen((function(t,n){e.setState(t.state)}));var t=D.location.state;t&&this.setState({url:t.url,feedId:t.feedId,articles:t.articles,feeds:t.feeds}),this.init()}},{key:"init",value:function(e){var t=this;this.setState({init:!1}),this.feeds().then((function(){t.setState({init:!0})})).catch((function(n){t.setState({init:!1}),setTimeout((function(){return t.init()}),2e3,e?e++:1)})),this.test("/feed/today")}},{key:"test",value:function(e){}},{key:"onErrorClose",value:function(e){this.setState({error:null})}},{key:"onToggleView",value:function(e){this.setState({view:"full"==e?"mini":"full"})}},{key:"render",value:function(){var e=this,t=this.state,n=t.articles,a=t.feeds,i=t.feedId,o=t.search,c=t.refreshing,s=t.loadingFeeds,l=t.init,u=t.error,d=t.pages,f=t.page,v=t.view,p=a.filter((function(e){return e._id===i}))[0]||{},k=void 0!==i&&i===c;return l?r.a.createElement("div",{className:"App"},r.a.createElement("div",{id:"left"},r.a.createElement(N,{onClick:function(t){return e.addFeed(t)}}),!s&&!o.length&&a.map((function(t,n){return r.a.createElement(m,{key:t._id,name:t.name,url:t.url,id:t._id,unread:t.unread,count:t.count,refreshing:c===t._id,onClick:function(){return e.loadFeed(t._id)},onRemove:function(){return e.deleteFeed(t._id)},onRefresh:function(){return e.refreshFeed(t._id)},onUpdate:function(t,n){return e.updateFeed(t,n)},selected:t._id===i})})),r.a.createElement(g,{message:s,loading:s}),!a.length&&r.a.createElement("div",{className:"refresh"},r.a.createElement(h,{onClick:function(){return e.feeds()},icon:"R"})),"\u200a"),r.a.createElement("div",{id:"right"},r.a.createElement("div",{id:"feed-header"},r.a.createElement("div",{id:"feed-title"},p.name),r.a.createElement("div",{id:"feed-tools"},r.a.createElement(h,{onClick:function(){return e.browse(-1)},icon:"-"}),r.a.createElement(h,{onClick:function(){},icon:f+"/"+d,size:11}),r.a.createElement(h,{onClick:function(){return e.browse(1)},icon:"+"}),r.a.createElement("div",{class:"button-spacer"}),r.a.createElement(h,{onClick:function(){return e.onToggleView(v)},icon:"V"}),r.a.createElement(h,{onClick:function(){return e.toggleAllRead(p._id)},icon:r.a.createElement(I.a,null)}),r.a.createElement(h,{onClick:function(){return e.refreshFeed(p._id)},icon:r.a.createElement(T.a,null)}))),r.a.createElement("div",{id:"feed"},r.a.createElement(b,{name:p.name,id:p._id,articles:n,refreshing:k,view:v,onClick:function(t,n){return e.openLink(t,n)},onToggleRead:function(t,n){return e.onToggleRead(i,t,n)}}))),u&&r.a.createElement(R,{error:u,onClose:function(){return e.onErrorClose(u)}})):r.a.createElement(g,{message:"Starting up...",loading:!0})}}]),n}(a.Component));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(i.a,{history:D},r.a.createElement(M,null))),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.9c4ec00e.chunk.js.map